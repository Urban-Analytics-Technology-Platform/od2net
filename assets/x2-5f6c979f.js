import{S as ie,i as re,s as fe,G as ge,e as q,h as N,z as U,l as D,I as $,q as J,J as V,K as pe,N as _e,O as be,Q as he,t as w,b as k,v as R,w as we,R as Le,T as ye,U as Y,V as ee,m as ke,L as Ce,c as P,f as I,a as z,d as O,o as ve,H as Me,x as X,y as K,g as x,n as B,A as W,r as te,u as ne,M as Be,_ as Se,W as ue,j as se,D as Ee,E as Pe,X as ze}from"./Layout-3cbf44cd.js";import{L as Oe,C as Ie,O as qe,_ as De,J as Re,a as Te,G as Je,P as Ne}from"./CostFunction-4625c6e9.js";import{S as je,L as Ae}from"./SidebarControls-7d7290fb.js";const Fe=s=>({marker:s&8}),ae=s=>({marker:s[3]});function Xe(s){let e,t,o,n,i,f,c;const l=s[19].default,r=ge(l,s,s[18],ae);return{c(){e=q("div"),r&&r.c(),N(e,"tabindex",t=s[1]?0:void 0),N(e,"role",o=s[1]?"button":void 0),U(e,"z-index",s[2])},m(a,d){D(a,e,d),r&&r.m(e,null),i=!0,f||(c=[$(s[7].call(null,e)),$(n=Ze.call(null,e,s[0])),J(e,"click",V(s[20])),J(e,"dblclick",V(s[21])),J(e,"contextmenu",V(s[22])),J(e,"mouseenter",s[23]),J(e,"mouseleave",s[24]),J(e,"mousemove",s[25]),J(e,"keydown",s[8])],f=!0)},p(a,[d]){r&&r.p&&(!i||d&262152)&&pe(r,l,a,a[18],i?be(l,a[18],d,Fe):_e(a[18]),ae),(!i||d&2&&t!==(t=a[1]?0:void 0))&&N(e,"tabindex",t),(!i||d&2&&o!==(o=a[1]?"button":void 0))&&N(e,"role",o),n&&he(n.update)&&d&1&&n.update.call(null,a[0]),d&4&&U(e,"z-index",a[2])},i(a){i||(w(r,a),i=!0)},o(a){k(r,a),i=!1},d(a){a&&R(e),r&&r.d(a),f=!1,we(c)}}}function Ze(s,e){const t=s.className;function o(n){n?s.className=`${t} ${n}`:s.className=t}return o(e),{update:o}}function Ge(s,e,t){let o,n,i,{$$slots:f={},$$scope:c}=e,{marker:l=void 0}=e,{lngLat:r}=e,{class:a=void 0}=e,{interactive:d=!0}=e,{asButton:y=!1}=e,{draggable:_=!1}=e,{feature:v=null}=e,{offset:g=void 0}=e,{zIndex:L=void 0}=e,{rotation:S=0}=e,{opacity:T=1}=e;const Z=Le(),{map:j,layerEvent:b,self:h}=ye();Y(s,j,u=>t(27,i=u)),Y(s,b,u=>t(26,o=u)),Y(s,h,u=>t(3,n=u));function p(u){ee(h,n=new ke.Marker({element:u,rotation:S,draggable:_,offset:g,opacity:T.toString()}).setLngLat(r).addTo(i),n),t(11,l=n);const F=()=>C("dragstart"),G=()=>{E(),C("drag")},H=()=>{E(),C("dragend")};return _&&(n.on("dragstart",F),n.on("drag",G),n.on("dragend",H)),{destroy(){_&&(n==null||n.off("dragstart",F),n==null||n.off("drag",G),n==null||n.off("dragend",H)),t(11,l=void 0),n==null||n.remove()}}}function E(){let u=n==null?void 0:n.getLngLat();u&&(Array.isArray(r)?t(10,r=[u.lng,u.lat]):r&&"lon"in r?t(10,r={lon:u.lng,lat:u.lat}):t(10,r=u))}function A(u){u.key===" "&&(u.preventDefault(),u.stopPropagation(),C("click"))}function C(u){if(!d)return;let F=n==null?void 0:n.getLngLat();if(!F)return;const G=[F.lng,F.lat];let H={map:i,marker:n,lngLat:G,features:[{type:"Feature",properties:(v==null?void 0:v.properties)??{},geometry:{type:"Point",coordinates:G}}]};ee(b,o={...H,layerType:"marker",type:u},o),Z(u,H)}const Q=()=>C("click"),m=()=>C("dblclick"),M=()=>C("contextmenu"),ce=u=>{C("mouseenter")},de=()=>{C("mouseleave")},me=()=>C("mousemove");return s.$$set=u=>{"marker"in u&&t(11,l=u.marker),"lngLat"in u&&t(10,r=u.lngLat),"class"in u&&t(0,a=u.class),"interactive"in u&&t(12,d=u.interactive),"asButton"in u&&t(1,y=u.asButton),"draggable"in u&&t(13,_=u.draggable),"feature"in u&&t(14,v=u.feature),"offset"in u&&t(15,g=u.offset),"zIndex"in u&&t(2,L=u.zIndex),"rotation"in u&&t(16,S=u.rotation),"opacity"in u&&t(17,T=u.opacity),"$$scope"in u&&t(18,c=u.$$scope)},s.$$.update=()=>{s.$$.dirty&1032&&(n==null||n.setLngLat(r)),s.$$.dirty&32776&&(n==null||n.setOffset(g??[0,0])),s.$$.dirty&65544&&(n==null||n.setRotation(S)),s.$$.dirty&131080&&(n==null||n.setOpacity(T.toString()))},[a,y,L,n,j,b,h,p,A,C,r,l,d,_,v,g,S,T,c,f,Q,m,M,ce,de,me]}class He extends ie{constructor(e){super(),re(this,e,Ge,Xe,fe,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}const Ue=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function oe(s){let e,t,o,n,i,f,c,l,r,a,d,y;function _(g){s[20](g)}let v={};return s[2]!==void 0&&(v.cost=s[2]),l=new Te({props:v}),X.push(()=>K(l,"cost",_)),{c(){e=q("div"),t=q("label"),o=x(`Max requests (limit for faster updates):
          `),n=q("br"),i=I(),f=q("input"),c=I(),P(l.$$.fragment),N(f,"type","number"),N(f,"min",1)},m(g,L){D(g,e,L),B(e,t),B(t,o),B(t,n),B(t,i),B(t,f),se(f,s[1]),D(g,c,L),z(l,g,L),a=!0,d||(y=J(f,"input",s[19]),d=!0)},p(g,L){L&2&&ue(f.value)!==g[1]&&se(f,g[1]);const S={};!r&&L&4&&(r=!0,S.cost=g[2],W(()=>r=!1)),l.$set(S)},i(g){a||(w(l.$$.fragment,g),a=!0)},o(g){k(l.$$.fragment,g),a=!1},d(g){g&&(R(e),R(c)),O(l,g),d=!1,y()}}}function le(s){let e,t,o,n,i;function f(l){s[21](l)}let c={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(c.controls=s[8]),o=new je({props:c}),X.push(()=>K(o,"controls",f)),{c(){e=q("hr"),t=I(),P(o.$$.fragment)},m(l,r){D(l,e,r),D(l,t,r),z(o,l,r),i=!0},p(l,r){const a={};r&64&&(a.outputMetadata=l[6].metadata),r&8&&(a.map=l[3]),!n&&r&256&&(n=!0,a.controls=l[8],W(()=>n=!1)),o.$set(a)},i(l){i||(w(o.$$.fragment,l),i=!0)},o(l){k(o.$$.fragment,l),i=!1},d(l){l&&(R(e),R(t)),O(o,l)}}}function Ke(s){let e,t,o,n,i,f,c,l,r,a,d,y,_,v,g,L,S,T;t=new Me({props:{app:"interactive"}});function Z(p){s[16](p)}let j={};s[0]!==void 0&&(j.example=s[0]),a=new Ie({props:j}),X.push(()=>K(a,"example",Z)),_=new qe({props:{map:s[3]}}),_.$on("gotXml",s[12]),_.$on("loading",s[17]),_.$on("error",s[18]);let b=s[4]&&oe(s),h=s[6].metadata&&le(s);return{c(){e=q("div"),P(t.$$.fragment),o=I(),n=q("label"),i=x("Open an "),f=q("i"),f.textContent=".osm.pbf",c=x(`
      file
      `),l=q("input"),r=I(),P(a.$$.fragment),y=I(),P(_.$$.fragment),v=I(),b&&b.c(),g=I(),h&&h.c(),N(l,"type","file"),N(e,"slot","left")},m(p,E){D(p,e,E),z(t,e,null),B(e,o),B(e,n),B(n,i),B(n,f),B(n,c),B(n,l),s[15](l),B(e,r),z(a,e,null),B(e,y),z(_,e,null),B(e,v),b&&b.m(e,null),B(e,g),h&&h.m(e,null),L=!0,S||(T=J(l,"change",s[10]),S=!0)},p(p,E){const A={};!d&&E&1&&(d=!0,A.example=p[0],W(()=>d=!1)),a.$set(A);const C={};E&8&&(C.map=p[3]),_.$set(C),p[4]?b?(b.p(p,E),E&16&&w(b,1)):(b=oe(p),b.c(),w(b,1),b.m(e,g)):b&&(te(),k(b,1,1,()=>{b=null}),ne()),p[6].metadata?h?(h.p(p,E),E&64&&w(h,1)):(h=le(p),h.c(),w(h,1),h.m(e,null)):h&&(te(),k(h,1,1,()=>{h=null}),ne())},i(p){L||(w(t.$$.fragment,p),w(a.$$.fragment,p),w(_.$$.fragment,p),w(b),w(h),L=!0)},o(p){k(t.$$.fragment,p),k(a.$$.fragment,p),k(_.$$.fragment,p),k(b),k(h),L=!1},d(p){p&&R(e),O(t),s[15](null),O(a),O(_),b&&b.d(),h&&h.d(),S=!1,T()}}}function We(s){let e,t;return{c(){e=new ze(!1),t=Ee(),e.a=t},m(o,n){e.m(Ue,o,n),D(o,t,n)},p:Pe,d(o){o&&(R(t),e.d())}}}function Qe(s){let e,t;return e=new Ae({props:{controls:s[8]}}),{c(){P(e.$$.fragment)},m(o,n){z(e,o,n),t=!0},p(o,n){const i={};n&256&&(i.controls=o[8]),e.$set(i)},i(o){t||(w(e.$$.fragment,o),t=!0)},o(o){k(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Ve(s){let e,t,o,n,i,f,c;function l(a){s[13](a)}let r={draggable:!0,$$slots:{default:[We]},$$scope:{ctx:s}};return s[5]!==void 0&&(r.lngLat=s[5]),e=new He({props:r}),X.push(()=>K(e,"lngLat",l)),e.$on("dragend",s[11]),n=new Je({props:{data:s[6],$$slots:{default:[Qe]},$$scope:{ctx:s}}}),f=new Ne({}),{c(){P(e.$$.fragment),o=I(),P(n.$$.fragment),i=I(),P(f.$$.fragment)},m(a,d){z(e,a,d),D(a,o,d),z(n,a,d),D(a,i,d),z(f,a,d),c=!0},p(a,d){const y={};d&33554432&&(y.$$scope={dirty:d,ctx:a}),!t&&d&32&&(t=!0,y.lngLat=a[5],W(()=>t=!1)),e.$set(y);const _={};d&64&&(_.data=a[6]),d&33554688&&(_.$$scope={dirty:d,ctx:a}),n.$set(_)},i(a){c||(w(e.$$.fragment,a),w(n.$$.fragment,a),w(f.$$.fragment,a),c=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),k(f.$$.fragment,a),c=!1},d(a){a&&(R(o),R(i)),O(e,a),O(n,a),O(f,a)}}}function Ye(s){let e,t,o,n;function i(c){s[14](c)}let f={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Ve]},$$scope:{ctx:s}};return s[3]!==void 0&&(f.map=s[3]),t=new Be({props:f}),X.push(()=>K(t,"map",i)),{c(){e=q("div"),P(t.$$.fragment),N(e,"slot","main"),U(e,"position","relative"),U(e,"width","100%"),U(e,"height","100vh")},m(c,l){D(c,e,l),z(t,e,null),n=!0},p(c,l){const r={};l&33554784&&(r.$$scope={dirty:l,ctx:c}),!o&&l&8&&(o=!0,r.map=c[3],W(()=>o=!1)),t.$set(r)},i(c){n||(w(t.$$.fragment,c),n=!0)},o(c){k(t.$$.fragment,c),n=!1},d(c){c&&R(e),O(t)}}}function xe(s){let e,t,o,n;return e=new Ce({props:{$$slots:{main:[Ye],left:[Ke]},$$scope:{ctx:s}}}),o=new Oe({props:{loading:s[7]}}),{c(){P(e.$$.fragment),t=I(),P(o.$$.fragment)},m(i,f){z(e,i,f),D(i,t,f),z(o,i,f),n=!0},p(i,[f]){const c={};f&33555455&&(c.$$scope={dirty:f,ctx:i}),e.$set(c);const l={};f&128&&(l.loading=i[7]),o.$set(l)},i(i){n||(w(e.$$.fragment,i),w(o.$$.fragment,i),n=!0)},o(i){k(e.$$.fragment,i),k(o.$$.fragment,i),n=!1},d(i){i&&R(t),O(e,i),O(o,i)}}}function $e(s,e,t){ve(async()=>{await De(),await Se()});let o,n,i="",f={lng:0,lat:0},c={type:"FeatureCollection",features:[]},l="",r=1e3,a="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function _(m){t(0,i=""),t(7,l="Loading file"),v(await y.files[0].arrayBuffer())}function v(m){try{t(4,n=new Re(new Uint8Array(m))),t(2,a="Distance");let M=n.getBounds();o.fitBounds([[M[0],M[1]],[M[2],M[3]]],{padding:20,animate:!1}),t(5,f.lng=(M[0]+M[2])/2,f),t(5,f.lat=(M[1]+M[3])/2,f),L()}catch(M){window.alert(`Problem importing osm.pbf file: ${M}`)}t(7,l="")}async function g(m){if(m!=""){t(7,l=`Loading ${m}`);let M=await fetch(`https://assets.od2net.org/pbf_clips/${m}.osm.pbf`);v(await M.arrayBuffer())}}function L(){n&&t(6,c=JSON.parse(n.recalculate({lng:f.lng,lat:f.lat,max_requests:r,cost:a})))}function S(m,M){L()}function T(m){t(7,l="Parsing XML"),v(new TextEncoder().encode(m.detail)),t(7,l="")}function Z(m){f=m,t(5,f)}function j(m){o=m,t(3,o)}function b(m){X[m?"unshift":"push"](()=>{y=m,t(9,y)})}function h(m){i=m,t(0,i)}const p=m=>t(7,l=m.detail),E=m=>t(7,l=m.detail);function A(){r=ue(this.value),t(1,r)}function C(m){a=m,t(2,a)}function Q(m){d=m,t(8,d)}return s.$$.update=()=>{s.$$.dirty&1&&g(i),s.$$.dirty&6&&S()},[i,r,a,o,n,f,c,l,d,y,_,L,T,Z,j,b,h,p,E,A,C,Q]}class et extends ie{constructor(e){super(),re(this,e,$e,xe,fe,{})}}new et({target:document.getElementById("app")});
