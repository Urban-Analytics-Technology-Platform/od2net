import{S as le,i as oe,s as ie,G as ce,e as q,h as J,z as X,l as D,I as $,q as T,J as de,K as pe,N as ge,O as me,t as y,b as C,v as R,w as _e,Q as be,R as he,T as V,U as x,m as we,L as Le,c as z,f as I,a as O,d as P,o as ye,H as Ce,x as G,y as K,g as Y,n as M,A as W,r as ee,u as te,M as ve,_ as ke,V as re,j as ne,D as Me,E as Be,W as Se}from"./Layout-663a57a0.js";import{L as Ee,C as ze,O as Oe,_ as Pe,J as Ie,a as qe,G as De,P as Re}from"./OverpassSelector-c7b40ba0.js";import{S as Te,L as Je}from"./SidebarControls-dfa034e3.js";function Ne(s){let e,t,o,n,i,r,c;const l=s[18].default,u=ce(l,s,s[17],null);return{c(){e=q("div"),u&&u.c(),J(e,"tabindex",t=s[1]?0:void 0),J(e,"role",o=s[1]?"button":void 0),X(e,"z-index",s[2])},m(a,d){D(a,e,d),u&&u.m(e,null),i=!0,r||(c=[$(s[6].call(null,e)),$(n=je.call(null,e,s[0])),T(e,"click",s[19]),T(e,"dblclick",s[20]),T(e,"contextmenu",s[21]),T(e,"mouseenter",s[22]),T(e,"mouseleave",s[23]),T(e,"mousemove",s[24]),T(e,"keydown",s[7])],r=!0)},p(a,[d]){u&&u.p&&(!i||d&131072)&&de(u,l,a,a[17],i?ge(l,a[17],d,null):pe(a[17]),null),(!i||d&2&&t!==(t=a[1]?0:void 0))&&J(e,"tabindex",t),(!i||d&2&&o!==(o=a[1]?"button":void 0))&&J(e,"role",o),n&&me(n.update)&&d&1&&n.update.call(null,a[0]),d&4&&X(e,"z-index",a[2])},i(a){i||(y(u,a),i=!0)},o(a){C(u,a),i=!1},d(a){a&&R(e),u&&u.d(a),r=!1,_e(c)}}}function je(s,e){const t=s.className;function o(n){n?s.className=`${t} ${n}`:s.className=t}return o(e),{update:o}}function Ae(s,e,t){let o,n,i,{$$slots:r={},$$scope:c}=e,{lngLat:l}=e,{class:u=void 0}=e,{interactive:a=!0}=e,{asButton:d=!1}=e,{draggable:w=!1}=e,{feature:_=null}=e,{offset:B=void 0}=e,{zIndex:m=void 0}=e,{rotation:L=0}=e,{opacity:S=1}=e;const j=be(),{map:A,layerEvent:N,self:b}=he();V(s,A,f=>t(26,i=f)),V(s,N,f=>t(25,o=f)),V(s,b,f=>t(16,n=f));function h(f){x(b,n=new we.Marker({element:f,rotation:L,draggable:w,offset:B,opacity:S.toString()}).setLngLat(l).addTo(i),n);const Z=()=>v("dragstart"),H=()=>{g(),v("drag")},U=()=>{g(),v("dragend")};return w&&(n.on("dragstart",Z),n.on("drag",H),n.on("dragend",U)),{destroy(){w&&(n==null||n.off("dragstart",Z),n==null||n.off("drag",H),n==null||n.off("dragend",U)),n==null||n.remove()}}}function g(){let f=n==null?void 0:n.getLngLat();f&&(Array.isArray(l)?t(9,l=[f.lng,f.lat]):l&&"lon"in l?t(9,l={lon:f.lng,lat:f.lat}):t(9,l=f))}function E(f){f.key===" "&&(f.preventDefault(),f.stopPropagation(),v("click"))}function v(f){if(!a)return;let Z=n==null?void 0:n.getLngLat();if(!Z)return;const H=[Z.lng,Z.lat];let U={map:i,marker:n,lngLat:H,features:[{type:"Feature",properties:(_==null?void 0:_.properties)??{},geometry:{type:"Point",coordinates:H}}]};x(N,o={...U,layerType:"marker",type:f},o),j(f,U)}const F=()=>v("click"),Q=()=>v("dblclick"),p=()=>v("contextmenu"),k=f=>{v("mouseenter")},fe=()=>{v("mouseleave")},ue=()=>v("mousemove");return s.$$set=f=>{"lngLat"in f&&t(9,l=f.lngLat),"class"in f&&t(0,u=f.class),"interactive"in f&&t(10,a=f.interactive),"asButton"in f&&t(1,d=f.asButton),"draggable"in f&&t(11,w=f.draggable),"feature"in f&&t(12,_=f.feature),"offset"in f&&t(13,B=f.offset),"zIndex"in f&&t(2,m=f.zIndex),"rotation"in f&&t(14,L=f.rotation),"opacity"in f&&t(15,S=f.opacity),"$$scope"in f&&t(17,c=f.$$scope)},s.$$.update=()=>{s.$$.dirty&66048&&(n==null||n.setLngLat(l)),s.$$.dirty&73728&&(n==null||n.setOffset(B??[0,0])),s.$$.dirty&81920&&(n==null||n.setRotation(L)),s.$$.dirty&98304&&(n==null||n.setOpacity(S.toString()))},[u,d,m,A,N,b,h,E,v,l,a,w,_,B,L,S,n,c,r,F,Q,p,k,fe,ue]}class Fe extends le{constructor(e){super(),oe(this,e,Ae,Ne,ie,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2,rotation:14,opacity:15})}}const Ze=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function se(s){let e,t,o,n,i,r,c,l,u,a,d,w;function _(m){s[20](m)}let B={};return s[2]!==void 0&&(B.cost=s[2]),l=new qe({props:B}),G.push(()=>K(l,"cost",_)),{c(){e=q("div"),t=q("label"),o=Y(`Max requests (limit for faster updates):
          `),n=q("br"),i=I(),r=q("input"),c=I(),z(l.$$.fragment),J(r,"type","number"),J(r,"min",1)},m(m,L){D(m,e,L),M(e,t),M(t,o),M(t,n),M(t,i),M(t,r),ne(r,s[1]),D(m,c,L),O(l,m,L),a=!0,d||(w=T(r,"input",s[19]),d=!0)},p(m,L){L&2&&re(r.value)!==m[1]&&ne(r,m[1]);const S={};!u&&L&4&&(u=!0,S.cost=m[2],W(()=>u=!1)),l.$set(S)},i(m){a||(y(l.$$.fragment,m),a=!0)},o(m){C(l.$$.fragment,m),a=!1},d(m){m&&(R(e),R(c)),P(l,m),d=!1,w()}}}function ae(s){let e,t,o,n,i;function r(l){s[21](l)}let c={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(c.controls=s[8]),o=new Te({props:c}),G.push(()=>K(o,"controls",r)),{c(){e=q("hr"),t=I(),z(o.$$.fragment)},m(l,u){D(l,e,u),D(l,t,u),O(o,l,u),i=!0},p(l,u){const a={};u&64&&(a.outputMetadata=l[6].metadata),u&8&&(a.map=l[3]),!n&&u&256&&(n=!0,a.controls=l[8],W(()=>n=!1)),o.$set(a)},i(l){i||(y(o.$$.fragment,l),i=!0)},o(l){C(o.$$.fragment,l),i=!1},d(l){l&&(R(e),R(t)),P(o,l)}}}function Ge(s){let e,t,o,n,i,r,c,l,u,a,d,w,_,B,m,L,S,j;t=new Ce({props:{app:"interactive"}});function A(g){s[16](g)}let N={};s[0]!==void 0&&(N.example=s[0]),a=new ze({props:N}),G.push(()=>K(a,"example",A)),_=new Oe({props:{map:s[3]}}),_.$on("gotXml",s[12]),_.$on("loading",s[17]),_.$on("error",s[18]);let b=s[4]&&se(s),h=s[6].metadata&&ae(s);return{c(){e=q("div"),z(t.$$.fragment),o=I(),n=q("label"),i=Y("Open an "),r=q("i"),r.textContent=".osm.pbf",c=Y(`
      file
      `),l=q("input"),u=I(),z(a.$$.fragment),w=I(),z(_.$$.fragment),B=I(),b&&b.c(),m=I(),h&&h.c(),J(l,"type","file"),J(e,"slot","left")},m(g,E){D(g,e,E),O(t,e,null),M(e,o),M(e,n),M(n,i),M(n,r),M(n,c),M(n,l),s[15](l),M(e,u),O(a,e,null),M(e,w),O(_,e,null),M(e,B),b&&b.m(e,null),M(e,m),h&&h.m(e,null),L=!0,S||(j=T(l,"change",s[10]),S=!0)},p(g,E){const v={};!d&&E&1&&(d=!0,v.example=g[0],W(()=>d=!1)),a.$set(v);const F={};E&8&&(F.map=g[3]),_.$set(F),g[4]?b?(b.p(g,E),E&16&&y(b,1)):(b=se(g),b.c(),y(b,1),b.m(e,m)):b&&(ee(),C(b,1,1,()=>{b=null}),te()),g[6].metadata?h?(h.p(g,E),E&64&&y(h,1)):(h=ae(g),h.c(),y(h,1),h.m(e,null)):h&&(ee(),C(h,1,1,()=>{h=null}),te())},i(g){L||(y(t.$$.fragment,g),y(a.$$.fragment,g),y(_.$$.fragment,g),y(b),y(h),L=!0)},o(g){C(t.$$.fragment,g),C(a.$$.fragment,g),C(_.$$.fragment,g),C(b),C(h),L=!1},d(g){g&&R(e),P(t),s[15](null),P(a),P(_),b&&b.d(),h&&h.d(),S=!1,j()}}}function He(s){let e,t;return{c(){e=new Se(!1),t=Me(),e.a=t},m(o,n){e.m(Ze,o,n),D(o,t,n)},p:Be,d(o){o&&(R(t),e.d())}}}function Ue(s){let e,t;return e=new Je({props:{controls:s[8]}}),{c(){z(e.$$.fragment)},m(o,n){O(e,o,n),t=!0},p(o,n){const i={};n&256&&(i.controls=o[8]),e.$set(i)},i(o){t||(y(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){P(e,o)}}}function Xe(s){let e,t,o,n,i,r,c;function l(a){s[13](a)}let u={draggable:!0,$$slots:{default:[He]},$$scope:{ctx:s}};return s[5]!==void 0&&(u.lngLat=s[5]),e=new Fe({props:u}),G.push(()=>K(e,"lngLat",l)),e.$on("dragend",s[11]),n=new De({props:{data:s[6],$$slots:{default:[Ue]},$$scope:{ctx:s}}}),r=new Re({}),{c(){z(e.$$.fragment),o=I(),z(n.$$.fragment),i=I(),z(r.$$.fragment)},m(a,d){O(e,a,d),D(a,o,d),O(n,a,d),D(a,i,d),O(r,a,d),c=!0},p(a,d){const w={};d&33554432&&(w.$$scope={dirty:d,ctx:a}),!t&&d&32&&(t=!0,w.lngLat=a[5],W(()=>t=!1)),e.$set(w);const _={};d&64&&(_.data=a[6]),d&33554688&&(_.$$scope={dirty:d,ctx:a}),n.$set(_)},i(a){c||(y(e.$$.fragment,a),y(n.$$.fragment,a),y(r.$$.fragment,a),c=!0)},o(a){C(e.$$.fragment,a),C(n.$$.fragment,a),C(r.$$.fragment,a),c=!1},d(a){a&&(R(o),R(i)),P(e,a),P(n,a),P(r,a)}}}function Ke(s){let e,t,o,n;function i(c){s[14](c)}let r={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Xe]},$$scope:{ctx:s}};return s[3]!==void 0&&(r.map=s[3]),t=new ve({props:r}),G.push(()=>K(t,"map",i)),{c(){e=q("div"),z(t.$$.fragment),J(e,"slot","main"),X(e,"position","relative"),X(e,"width","100%"),X(e,"height","100vh")},m(c,l){D(c,e,l),O(t,e,null),n=!0},p(c,l){const u={};l&33554784&&(u.$$scope={dirty:l,ctx:c}),!o&&l&8&&(o=!0,u.map=c[3],W(()=>o=!1)),t.$set(u)},i(c){n||(y(t.$$.fragment,c),n=!0)},o(c){C(t.$$.fragment,c),n=!1},d(c){c&&R(e),P(t)}}}function We(s){let e,t,o,n;return e=new Le({props:{$$slots:{main:[Ke],left:[Ge]},$$scope:{ctx:s}}}),o=new Ee({props:{loading:s[7]}}),{c(){z(e.$$.fragment),t=I(),z(o.$$.fragment)},m(i,r){O(e,i,r),D(i,t,r),O(o,i,r),n=!0},p(i,[r]){const c={};r&33555455&&(c.$$scope={dirty:r,ctx:i}),e.$set(c);const l={};r&128&&(l.loading=i[7]),o.$set(l)},i(i){n||(y(e.$$.fragment,i),y(o.$$.fragment,i),n=!0)},o(i){C(e.$$.fragment,i),C(o.$$.fragment,i),n=!1},d(i){i&&R(t),P(e,i),P(o,i)}}}function Qe(s,e,t){ye(async()=>{await Pe(),await ke()});let o,n,i="",r={lng:0,lat:0},c={type:"FeatureCollection",features:[]},l="",u=1e3,a="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},w;async function _(p){t(0,i=""),t(7,l="Loading file"),B(await w.files[0].arrayBuffer())}function B(p){try{t(4,n=new Ie(new Uint8Array(p))),t(2,a="Distance");let k=n.getBounds();o.fitBounds([[k[0],k[1]],[k[2],k[3]]],{padding:20,animate:!1}),t(5,r.lng=(k[0]+k[2])/2,r),t(5,r.lat=(k[1]+k[3])/2,r),L()}catch(k){window.alert(`Problem importing osm.pbf file: ${k}`)}t(7,l="")}async function m(p){if(p!=""){t(7,l=`Loading ${p}`);let k=await fetch(`https://assets.od2net.org/pbf_clips/${p}.osm.pbf`);B(await k.arrayBuffer())}}function L(){n&&t(6,c=JSON.parse(n.recalculate({lng:r.lng,lat:r.lat,max_requests:u,cost:a})))}function S(p,k){L()}function j(p){t(7,l="Parsing XML"),B(new TextEncoder().encode(p.detail)),t(7,l="")}function A(p){r=p,t(5,r)}function N(p){o=p,t(3,o)}function b(p){G[p?"unshift":"push"](()=>{w=p,t(9,w)})}function h(p){i=p,t(0,i)}const g=p=>t(7,l=p.detail),E=p=>t(7,l=p.detail);function v(){u=re(this.value),t(1,u)}function F(p){a=p,t(2,a)}function Q(p){d=p,t(8,d)}return s.$$.update=()=>{s.$$.dirty&1&&m(i),s.$$.dirty&6&&S()},[i,u,a,o,n,r,c,l,d,w,_,L,j,A,N,b,h,g,E,v,F,Q]}class Ve extends le{constructor(e){super(),oe(this,e,Qe,We,ie,{})}}new Ve({target:document.getElementById("app")});
