import{S as ie,i as re,s as fe,G as pe,e as q,h as J,z as K,l as D,I as $,q as A,J as V,K as _e,N as be,O as he,Q as we,R as Le,t as w,b as k,v as R,w as ye,T as ke,U as Ce,V as Y,W as ee,m as ve,L as Me,c as P,f as O,a as z,d as I,o as Be,H as Se,x as G,y as W,g as x,n as M,A as Q,r as te,u as ne,M as Ee,_ as Pe,X as ue,j as se,D as ze,E as Ie,Y as Oe}from"./Layout-63eb556b.js";import{L as qe,C as De,O as Re,_ as Te,J as Ae,a as Je,G as je,P as Fe}from"./index-1a302ef2.js";import{S as Ne,L as Xe}from"./SidebarControls-46e78039.js";const Ze=s=>({marker:s&8}),ae=s=>({marker:s[3]});function Ge(s){let e,t,l,n,i,f,c;const o=s[19].default,r=pe(o,s,s[18],ae);return{c(){e=q("div"),r&&r.c(),J(e,"tabindex",t=s[1]?0:void 0),J(e,"role",l=s[1]?"button":void 0),K(e,"z-index",s[2])},m(a,d){D(a,e,d),r&&r.m(e,null),i=!0,f||(c=[$(s[7].call(null,e)),$(n=He.call(null,e,s[0])),A(e,"click",V(s[20])),A(e,"dblclick",V(s[21])),A(e,"contextmenu",V(_e(s[22]))),A(e,"mouseenter",s[23]),A(e,"mouseleave",s[24]),A(e,"mousemove",s[25]),A(e,"keydown",s[8])],f=!0)},p(a,[d]){r&&r.p&&(!i||d&262152)&&be(r,o,a,a[18],i?we(o,a[18],d,Ze):he(a[18]),ae),(!i||d&2&&t!==(t=a[1]?0:void 0))&&J(e,"tabindex",t),(!i||d&2&&l!==(l=a[1]?"button":void 0))&&J(e,"role",l),n&&Le(n.update)&&d&1&&n.update.call(null,a[0]),d&4&&K(e,"z-index",a[2])},i(a){i||(w(r,a),i=!0)},o(a){k(r,a),i=!1},d(a){a&&R(e),r&&r.d(a),f=!1,ye(c)}}}function He(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function Ue(s,e,t){let l,n,i,{$$slots:f={},$$scope:c}=e,{marker:o=void 0}=e,{lngLat:r}=e,{class:a=void 0}=e,{interactive:d=!0}=e,{asButton:y=!1}=e,{draggable:_=!1}=e,{feature:C=null}=e,{offset:m=void 0}=e,{zIndex:L=void 0}=e,{rotation:B=0}=e,{opacity:T=1}=e;const H=ke(),{map:j,layerEvent:b,self:h,markerClickManager:p}=Ce();Y(s,j,u=>t(27,i=u)),Y(s,b,u=>t(26,l=u)),Y(s,h,u=>t(3,n=u));function E(u){ee(h,n=new ve.Marker({element:u,rotation:B,draggable:_,offset:m,opacity:T.toString()}).setLngLat(r).addTo(i),n),t(11,o=n);const X=()=>S("dragstart"),U=()=>{F(),S("drag")},Z=()=>{F(),S("dragend")};return _&&(n.on("dragstart",X),n.on("drag",U),n.on("dragend",Z)),{destroy(){_&&(n==null||n.off("dragstart",X),n==null||n.off("drag",U),n==null||n.off("dragend",Z)),t(11,o=void 0),n==null||n.remove()}}}function F(){let u=n==null?void 0:n.getLngLat();u&&(Array.isArray(r)?t(10,r=[u.lng,u.lat]):r&&"lon"in r?t(10,r={lon:u.lng,lat:u.lat}):t(10,r=u))}function N(u){u.key===" "&&(u.preventDefault(),u.stopPropagation(),S("click"))}function S(u){if(!d)return;let X=n==null?void 0:n.getLngLat();if(!X)return;const U=[X.lng,X.lat];let Z={map:i,marker:n,lngLat:U,features:[{type:"Feature",properties:(C==null?void 0:C.properties)??{},geometry:{type:"Point",coordinates:U}}]};(u==="click"||u==="contextmenu")&&p.handleClick(Z),ee(b,l={...Z,layerType:"marker",type:u},l),H(u,Z)}const g=()=>S("click"),v=()=>S("dblclick"),ce=()=>{S("contextmenu")},de=()=>{S("mouseenter")},ge=()=>{S("mouseleave")},me=()=>S("mousemove");return s.$$set=u=>{"marker"in u&&t(11,o=u.marker),"lngLat"in u&&t(10,r=u.lngLat),"class"in u&&t(0,a=u.class),"interactive"in u&&t(12,d=u.interactive),"asButton"in u&&t(1,y=u.asButton),"draggable"in u&&t(13,_=u.draggable),"feature"in u&&t(14,C=u.feature),"offset"in u&&t(15,m=u.offset),"zIndex"in u&&t(2,L=u.zIndex),"rotation"in u&&t(16,B=u.rotation),"opacity"in u&&t(17,T=u.opacity),"$$scope"in u&&t(18,c=u.$$scope)},s.$$.update=()=>{s.$$.dirty&1032&&(n==null||n.setLngLat(r)),s.$$.dirty&32776&&(n==null||n.setOffset(m??[0,0])),s.$$.dirty&65544&&(n==null||n.setRotation(B)),s.$$.dirty&131080&&(n==null||n.setOpacity(T.toString()))},[a,y,L,n,j,b,h,E,N,S,r,o,d,_,C,m,B,T,c,f,g,v,ce,de,ge,me]}class Ke extends ie{constructor(e){super(),re(this,e,Ue,Ge,fe,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}const We=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function le(s){let e,t,l,n,i,f,c,o,r,a,d,y;function _(m){s[20](m)}let C={};return s[2]!==void 0&&(C.cost=s[2]),o=new Je({props:C}),G.push(()=>W(o,"cost",_)),{c(){e=q("div"),t=q("label"),l=x(`Max requests (limit for faster updates):
          `),n=q("br"),i=O(),f=q("input"),c=O(),P(o.$$.fragment),J(f,"type","number"),J(f,"min",1)},m(m,L){D(m,e,L),M(e,t),M(t,l),M(t,n),M(t,i),M(t,f),se(f,s[1]),D(m,c,L),z(o,m,L),a=!0,d||(y=A(f,"input",s[19]),d=!0)},p(m,L){L&2&&ue(f.value)!==m[1]&&se(f,m[1]);const B={};!r&&L&4&&(r=!0,B.cost=m[2],Q(()=>r=!1)),o.$set(B)},i(m){a||(w(o.$$.fragment,m),a=!0)},o(m){k(o.$$.fragment,m),a=!1},d(m){m&&(R(e),R(c)),I(o,m),d=!1,y()}}}function oe(s){let e,t,l,n,i;function f(o){s[21](o)}let c={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(c.controls=s[8]),l=new Ne({props:c}),G.push(()=>W(l,"controls",f)),{c(){e=q("hr"),t=O(),P(l.$$.fragment)},m(o,r){D(o,e,r),D(o,t,r),z(l,o,r),i=!0},p(o,r){const a={};r&64&&(a.outputMetadata=o[6].metadata),r&8&&(a.map=o[3]),!n&&r&256&&(n=!0,a.controls=o[8],Q(()=>n=!1)),l.$set(a)},i(o){i||(w(l.$$.fragment,o),i=!0)},o(o){k(l.$$.fragment,o),i=!1},d(o){o&&(R(e),R(t)),I(l,o)}}}function Qe(s){let e,t,l,n,i,f,c,o,r,a,d,y,_,C,m,L,B,T;t=new Se({props:{app:"interactive"}});function H(p){s[16](p)}let j={};s[0]!==void 0&&(j.example=s[0]),a=new De({props:j}),G.push(()=>W(a,"example",H)),_=new Re({props:{map:s[3]}}),_.$on("gotXml",s[12]),_.$on("loading",s[17]),_.$on("error",s[18]);let b=s[4]&&le(s),h=s[6].metadata&&oe(s);return{c(){e=q("div"),P(t.$$.fragment),l=O(),n=q("label"),i=x("Open an "),f=q("i"),f.textContent=".osm.pbf",c=x(`
      file
      `),o=q("input"),r=O(),P(a.$$.fragment),y=O(),P(_.$$.fragment),C=O(),b&&b.c(),m=O(),h&&h.c(),J(o,"type","file"),J(e,"slot","left")},m(p,E){D(p,e,E),z(t,e,null),M(e,l),M(e,n),M(n,i),M(n,f),M(n,c),M(n,o),s[15](o),M(e,r),z(a,e,null),M(e,y),z(_,e,null),M(e,C),b&&b.m(e,null),M(e,m),h&&h.m(e,null),L=!0,B||(T=A(o,"change",s[10]),B=!0)},p(p,E){const F={};!d&&E&1&&(d=!0,F.example=p[0],Q(()=>d=!1)),a.$set(F);const N={};E&8&&(N.map=p[3]),_.$set(N),p[4]?b?(b.p(p,E),E&16&&w(b,1)):(b=le(p),b.c(),w(b,1),b.m(e,m)):b&&(te(),k(b,1,1,()=>{b=null}),ne()),p[6].metadata?h?(h.p(p,E),E&64&&w(h,1)):(h=oe(p),h.c(),w(h,1),h.m(e,null)):h&&(te(),k(h,1,1,()=>{h=null}),ne())},i(p){L||(w(t.$$.fragment,p),w(a.$$.fragment,p),w(_.$$.fragment,p),w(b),w(h),L=!0)},o(p){k(t.$$.fragment,p),k(a.$$.fragment,p),k(_.$$.fragment,p),k(b),k(h),L=!1},d(p){p&&R(e),I(t),s[15](null),I(a),I(_),b&&b.d(),h&&h.d(),B=!1,T()}}}function Ve(s){let e,t;return{c(){e=new Oe(!1),t=ze(),e.a=t},m(l,n){e.m(We,l,n),D(l,t,n)},p:Ie,d(l){l&&(R(t),e.d())}}}function Ye(s){let e,t;return e=new Xe({props:{controls:s[8]}}),{c(){P(e.$$.fragment)},m(l,n){z(e,l,n),t=!0},p(l,n){const i={};n&256&&(i.controls=l[8]),e.$set(i)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){k(e.$$.fragment,l),t=!1},d(l){I(e,l)}}}function xe(s){let e,t,l,n,i,f,c;function o(a){s[13](a)}let r={draggable:!0,$$slots:{default:[Ve]},$$scope:{ctx:s}};return s[5]!==void 0&&(r.lngLat=s[5]),e=new Ke({props:r}),G.push(()=>W(e,"lngLat",o)),e.$on("dragend",s[11]),n=new je({props:{data:s[6],$$slots:{default:[Ye]},$$scope:{ctx:s}}}),f=new Fe({}),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment),i=O(),P(f.$$.fragment)},m(a,d){z(e,a,d),D(a,l,d),z(n,a,d),D(a,i,d),z(f,a,d),c=!0},p(a,d){const y={};d&33554432&&(y.$$scope={dirty:d,ctx:a}),!t&&d&32&&(t=!0,y.lngLat=a[5],Q(()=>t=!1)),e.$set(y);const _={};d&64&&(_.data=a[6]),d&33554688&&(_.$$scope={dirty:d,ctx:a}),n.$set(_)},i(a){c||(w(e.$$.fragment,a),w(n.$$.fragment,a),w(f.$$.fragment,a),c=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),k(f.$$.fragment,a),c=!1},d(a){a&&(R(l),R(i)),I(e,a),I(n,a),I(f,a)}}}function $e(s){let e,t,l,n;function i(c){s[14](c)}let f={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[xe]},$$scope:{ctx:s}};return s[3]!==void 0&&(f.map=s[3]),t=new Ee({props:f}),G.push(()=>W(t,"map",i)),{c(){e=q("div"),P(t.$$.fragment),J(e,"slot","main"),K(e,"position","relative"),K(e,"width","100%"),K(e,"height","100vh")},m(c,o){D(c,e,o),z(t,e,null),n=!0},p(c,o){const r={};o&33554784&&(r.$$scope={dirty:o,ctx:c}),!l&&o&8&&(l=!0,r.map=c[3],Q(()=>l=!1)),t.$set(r)},i(c){n||(w(t.$$.fragment,c),n=!0)},o(c){k(t.$$.fragment,c),n=!1},d(c){c&&R(e),I(t)}}}function et(s){let e,t,l,n;return e=new Me({props:{$$slots:{main:[$e],left:[Qe]},$$scope:{ctx:s}}}),l=new qe({props:{loading:s[7]}}),{c(){P(e.$$.fragment),t=O(),P(l.$$.fragment)},m(i,f){z(e,i,f),D(i,t,f),z(l,i,f),n=!0},p(i,[f]){const c={};f&33555455&&(c.$$scope={dirty:f,ctx:i}),e.$set(c);const o={};f&128&&(o.loading=i[7]),l.$set(o)},i(i){n||(w(e.$$.fragment,i),w(l.$$.fragment,i),n=!0)},o(i){k(e.$$.fragment,i),k(l.$$.fragment,i),n=!1},d(i){i&&R(t),I(e,i),I(l,i)}}}function tt(s,e,t){Be(async()=>{await Te(),await Pe()});let l,n,i="",f={lng:0,lat:0},c={type:"FeatureCollection",features:[]},o="",r=1e3,a="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function _(g){t(0,i=""),t(7,o="Loading file"),C(await y.files[0].arrayBuffer())}function C(g){try{t(4,n=new Ae(new Uint8Array(g))),t(2,a="Distance");let v=n.getBounds();l.fitBounds([[v[0],v[1]],[v[2],v[3]]],{padding:20,animate:!1}),t(5,f.lng=(v[0]+v[2])/2,f),t(5,f.lat=(v[1]+v[3])/2,f),L()}catch(v){window.alert(`Problem importing osm.pbf file: ${v}`)}t(7,o="")}async function m(g){if(g!=""){t(7,o=`Loading ${g}`);let v=await fetch(`https://assets.od2net.org/pbf_clips/${g}.osm.pbf`);C(await v.arrayBuffer())}}function L(){n&&t(6,c=JSON.parse(n.recalculate({lng:f.lng,lat:f.lat,max_requests:r,cost:a})))}function B(g,v){L()}function T(g){t(7,o="Parsing XML"),C(new TextEncoder().encode(g.detail)),t(7,o="")}function H(g){f=g,t(5,f)}function j(g){l=g,t(3,l)}function b(g){G[g?"unshift":"push"](()=>{y=g,t(9,y)})}function h(g){i=g,t(0,i)}const p=g=>t(7,o=g.detail),E=g=>t(7,o=g.detail);function F(){r=ue(this.value),t(1,r)}function N(g){a=g,t(2,a)}function S(g){d=g,t(8,d)}return s.$$.update=()=>{s.$$.dirty&1&&m(i),s.$$.dirty&6&&B()},[i,r,a,l,n,f,c,o,d,y,_,L,T,H,j,b,h,p,E,F,N,S]}class nt extends ie{constructor(e){super(),re(this,e,tt,et,fe,{})}}new nt({target:document.getElementById("app")});
