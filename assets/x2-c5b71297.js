import{S as re,i as ie,s as fe,G as _e,e as S,f as z,A as K,g as R,I as $,u as J,J as V,K as be,N as he,O as we,Q as ye,R as Le,t as h,b as k,h as T,x as ke,T as Ce,U as ve,V as Y,W as ee,m as Me,L as Be,c as I,j as A,a as O,d as q,o as Se,H as Ee,n as ue,y as H,z as W,k as x,q as v,B as Q,v as te,w as ne,M as Pe,_ as ze,X as ce,l as ae,E as Ie,Y as Oe}from"./Layout-0eeb92fa.js";import{L as qe,C as Re,O as Te,_ as Ae,J as De,a as Je,G as je,P as Fe}from"./index-37e833ab.js";import{S as Ne,L as Xe}from"./SidebarControls-cf65590b.js";const Ze=a=>({marker:a&8}),se=a=>({marker:a[3]});function Ge(a){let e,t,s,n,l,c,u;const i=a[19].default,r=_e(i,a,a[18],se);return{c(){e=S("div"),r&&r.c(),z(e,"tabindex",t=a[1]?0:void 0),z(e,"role",s=a[1]?"button":void 0),K(e,"z-index",a[2])},m(o,d){R(o,e,d),r&&r.m(e,null),l=!0,c||(u=[$(a[7].call(null,e)),$(n=He.call(null,e,a[0])),J(e,"click",V(a[20])),J(e,"dblclick",V(a[21])),J(e,"contextmenu",V(be(a[22]))),J(e,"mouseenter",a[23]),J(e,"mouseleave",a[24]),J(e,"mousemove",a[25]),J(e,"keydown",a[8])],c=!0)},p(o,[d]){r&&r.p&&(!l||d&262152)&&he(r,i,o,o[18],l?ye(i,o[18],d,Ze):we(o[18]),se),(!l||d&2&&t!==(t=o[1]?0:void 0))&&z(e,"tabindex",t),(!l||d&2&&s!==(s=o[1]?"button":void 0))&&z(e,"role",s),n&&Le(n.update)&&d&1&&n.update.call(null,o[0]),d&4&&K(e,"z-index",o[2])},i(o){l||(h(r,o),l=!0)},o(o){k(r,o),l=!1},d(o){o&&T(e),r&&r.d(o),c=!1,ke(u)}}}function He(a,e){const t=a.className;function s(n){n?a.className=`${t} ${n}`:a.className=t}return s(e),{update:s}}function Ue(a,e,t){let s,n,l,{$$slots:c={},$$scope:u}=e,{marker:i=void 0}=e,{lngLat:r}=e,{class:o=void 0}=e,{interactive:d=!0}=e,{asButton:y=!1}=e,{draggable:L=!1}=e,{feature:p=null}=e,{offset:w=void 0}=e,{zIndex:E=void 0}=e,{rotation:D=0}=e,{opacity:P=1}=e;const F=Ce(),{map:N,layerEvent:X,self:j,markerClickManager:_}=ve();Y(a,N,f=>t(27,l=f)),Y(a,X,f=>t(26,s=f)),Y(a,j,f=>t(3,n=f));function b(f){ee(j,n=new Me.Marker({element:f,rotation:D,draggable:L,offset:w,opacity:P.toString()}).setLngLat(r).addTo(l),n),t(11,i=n);const Z=()=>C("dragstart"),U=()=>{g(),C("drag")},G=()=>{g(),C("dragend")};return L&&(n.on("dragstart",Z),n.on("drag",U),n.on("dragend",G)),{destroy(){L&&(n==null||n.off("dragstart",Z),n==null||n.off("drag",U),n==null||n.off("dragend",G)),t(11,i=void 0),n==null||n.remove()}}}function g(){let f=n==null?void 0:n.getLngLat();f&&(Array.isArray(r)?t(10,r=[f.lng,f.lat]):r&&"lon"in r?t(10,r={lon:f.lng,lat:f.lat}):t(10,r=f))}function B(f){f.key===" "&&(f.preventDefault(),f.stopPropagation(),C("click"))}function C(f){if(!d)return;let Z=n==null?void 0:n.getLngLat();if(!Z)return;const U=[Z.lng,Z.lat];let G={map:l,marker:n,lngLat:U,features:[{type:"Feature",properties:(p==null?void 0:p.properties)??{},geometry:{type:"Point",coordinates:U}}]};(f==="click"||f==="contextmenu")&&_.handleClick(G),ee(X,s={...G,layerType:"marker",type:f},s),F(f,G)}const m=()=>C("click"),M=()=>C("dblclick"),de=()=>{C("contextmenu")},pe=()=>{C("mouseenter")},me=()=>{C("mouseleave")},ge=()=>C("mousemove");return a.$$set=f=>{"marker"in f&&t(11,i=f.marker),"lngLat"in f&&t(10,r=f.lngLat),"class"in f&&t(0,o=f.class),"interactive"in f&&t(12,d=f.interactive),"asButton"in f&&t(1,y=f.asButton),"draggable"in f&&t(13,L=f.draggable),"feature"in f&&t(14,p=f.feature),"offset"in f&&t(15,w=f.offset),"zIndex"in f&&t(2,E=f.zIndex),"rotation"in f&&t(16,D=f.rotation),"opacity"in f&&t(17,P=f.opacity),"$$scope"in f&&t(18,u=f.$$scope)},a.$$.update=()=>{a.$$.dirty&1032&&(n==null||n.setLngLat(r)),a.$$.dirty&32776&&(n==null||n.setOffset(w??[0,0])),a.$$.dirty&65544&&(n==null||n.setRotation(D)),a.$$.dirty&131080&&(n==null||n.setOpacity(P.toString()))},[o,y,E,n,N,X,j,b,B,C,r,i,d,L,p,w,D,P,u,c,m,M,de,pe,me,ge]}class Ke extends re{constructor(e){super(),ie(this,e,Ue,Ge,fe,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}const We=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function Qe(a){let e,t,s;return t=new Ee({props:{app:"interactive"}}),{c(){e=S("div"),I(t.$$.fragment),z(e,"slot","top")},m(n,l){R(n,e,l),O(t,e,null),s=!0},p:ue,i(n){s||(h(t.$$.fragment,n),s=!0)},o(n){k(t.$$.fragment,n),s=!1},d(n){n&&T(e),q(t)}}}function le(a){let e,t,s,n,l,c,u,i,r,o,d;function y(p){a[20](p)}let L={};return a[2]!==void 0&&(L.cost=a[2]),u=new Je({props:L}),H.push(()=>W(u,"cost",y)),{c(){e=S("label"),t=x(`Max requests (limit for faster updates):
        `),s=S("br"),n=A(),l=S("input"),c=A(),I(u.$$.fragment),z(l,"type","number"),z(l,"min",1)},m(p,w){R(p,e,w),v(e,t),v(e,s),v(e,n),v(e,l),ae(l,a[1]),R(p,c,w),O(u,p,w),r=!0,o||(d=J(l,"input",a[19]),o=!0)},p(p,w){w&2&&ce(l.value)!==p[1]&&ae(l,p[1]);const E={};!i&&w&4&&(i=!0,E.cost=p[2],Q(()=>i=!1)),u.$set(E)},i(p){r||(h(u.$$.fragment,p),r=!0)},o(p){k(u.$$.fragment,p),r=!1},d(p){p&&(T(e),T(c)),q(u,p),o=!1,d()}}}function oe(a){let e,t,s,n,l;function c(i){a[21](i)}let u={outputMetadata:a[6].metadata,map:a[3]};return a[8]!==void 0&&(u.controls=a[8]),s=new Ne({props:u}),H.push(()=>W(s,"controls",c)),{c(){e=S("hr"),t=A(),I(s.$$.fragment)},m(i,r){R(i,e,r),R(i,t,r),O(s,i,r),l=!0},p(i,r){const o={};r&64&&(o.outputMetadata=i[6].metadata),r&8&&(o.map=i[3]),!n&&r&256&&(n=!0,o.controls=i[8],Q(()=>n=!1)),s.$set(o)},i(i){l||(h(s.$$.fragment,i),l=!0)},o(i){k(s.$$.fragment,i),l=!1},d(i){i&&(T(e),T(t)),q(s,i)}}}function Ve(a){let e,t,s,n,l,c,u,i,r,o,d,y,L,p,w,E,D,P,F,N;function X(g){a[16](g)}let j={};a[0]!==void 0&&(j.example=a[0]),d=new Re({props:j}),H.push(()=>W(d,"example",X)),p=new Te({props:{map:a[3]}}),p.$on("gotXml",a[12]),p.$on("loading",a[17]),p.$on("error",a[18]);let _=a[4]&&le(a),b=a[6].metadata&&oe(a);return{c(){e=S("div"),t=S("details"),s=S("summary"),s.textContent="Change areas",n=A(),l=S("label"),c=x("Open an "),u=S("i"),u.textContent=".osm.pbf",i=x(`
        file
        `),r=S("input"),o=A(),I(d.$$.fragment),L=A(),I(p.$$.fragment),E=A(),_&&_.c(),D=A(),b&&b.c(),z(s,"role","button"),z(s,"class","secondary"),z(r,"type","file"),t.open=w=!a[4],z(e,"slot","left")},m(g,B){R(g,e,B),v(e,t),v(t,s),v(t,n),v(t,l),v(l,c),v(l,u),v(l,i),v(l,r),a[15](r),v(t,o),O(d,t,null),v(t,L),O(p,t,null),v(e,E),_&&_.m(e,null),v(e,D),b&&b.m(e,null),P=!0,F||(N=J(r,"change",a[10]),F=!0)},p(g,B){const C={};!y&&B&1&&(y=!0,C.example=g[0],Q(()=>y=!1)),d.$set(C);const m={};B&8&&(m.map=g[3]),p.$set(m),(!P||B&16&&w!==(w=!g[4]))&&(t.open=w),g[4]?_?(_.p(g,B),B&16&&h(_,1)):(_=le(g),_.c(),h(_,1),_.m(e,D)):_&&(te(),k(_,1,1,()=>{_=null}),ne()),g[6].metadata?b?(b.p(g,B),B&64&&h(b,1)):(b=oe(g),b.c(),h(b,1),b.m(e,null)):b&&(te(),k(b,1,1,()=>{b=null}),ne())},i(g){P||(h(d.$$.fragment,g),h(p.$$.fragment,g),h(_),h(b),P=!0)},o(g){k(d.$$.fragment,g),k(p.$$.fragment,g),k(_),k(b),P=!1},d(g){g&&T(e),a[15](null),q(d),q(p),_&&_.d(),b&&b.d(),F=!1,N()}}}function Ye(a){let e,t;return{c(){e=new Oe(!1),t=Ie(),e.a=t},m(s,n){e.m(We,s,n),R(s,t,n)},p:ue,d(s){s&&(T(t),e.d())}}}function xe(a){let e,t;return e=new Xe({props:{controls:a[8]}}),{c(){I(e.$$.fragment)},m(s,n){O(e,s,n),t=!0},p(s,n){const l={};n&256&&(l.controls=s[8]),e.$set(l)},i(s){t||(h(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){q(e,s)}}}function $e(a){let e,t,s,n,l,c,u;function i(o){a[13](o)}let r={draggable:!0,$$slots:{default:[Ye]},$$scope:{ctx:a}};return a[5]!==void 0&&(r.lngLat=a[5]),e=new Ke({props:r}),H.push(()=>W(e,"lngLat",i)),e.$on("dragend",a[11]),n=new je({props:{data:a[6],$$slots:{default:[xe]},$$scope:{ctx:a}}}),c=new Fe({}),{c(){I(e.$$.fragment),s=A(),I(n.$$.fragment),l=A(),I(c.$$.fragment)},m(o,d){O(e,o,d),R(o,s,d),O(n,o,d),R(o,l,d),O(c,o,d),u=!0},p(o,d){const y={};d&33554432&&(y.$$scope={dirty:d,ctx:o}),!t&&d&32&&(t=!0,y.lngLat=o[5],Q(()=>t=!1)),e.$set(y);const L={};d&64&&(L.data=o[6]),d&33554688&&(L.$$scope={dirty:d,ctx:o}),n.$set(L)},i(o){u||(h(e.$$.fragment,o),h(n.$$.fragment,o),h(c.$$.fragment,o),u=!0)},o(o){k(e.$$.fragment,o),k(n.$$.fragment,o),k(c.$$.fragment,o),u=!1},d(o){o&&(T(s),T(l)),q(e,o),q(n,o),q(c,o)}}}function et(a){let e,t,s,n;function l(u){a[14](u)}let c={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[$e]},$$scope:{ctx:a}};return a[3]!==void 0&&(c.map=a[3]),t=new Pe({props:c}),H.push(()=>W(t,"map",l)),{c(){e=S("div"),I(t.$$.fragment),z(e,"slot","main"),K(e,"position","relative"),K(e,"width","100%"),K(e,"height","100vh")},m(u,i){R(u,e,i),O(t,e,null),n=!0},p(u,i){const r={};i&33554784&&(r.$$scope={dirty:i,ctx:u}),!s&&i&8&&(s=!0,r.map=u[3],Q(()=>s=!1)),t.$set(r)},i(u){n||(h(t.$$.fragment,u),n=!0)},o(u){k(t.$$.fragment,u),n=!1},d(u){u&&T(e),q(t)}}}function tt(a){let e,t,s,n;return e=new Be({props:{$$slots:{main:[et],left:[Ve],top:[Qe]},$$scope:{ctx:a}}}),s=new qe({props:{loading:a[7]}}),{c(){I(e.$$.fragment),t=A(),I(s.$$.fragment)},m(l,c){O(e,l,c),R(l,t,c),O(s,l,c),n=!0},p(l,[c]){const u={};c&33555455&&(u.$$scope={dirty:c,ctx:l}),e.$set(u);const i={};c&128&&(i.loading=l[7]),s.$set(i)},i(l){n||(h(e.$$.fragment,l),h(s.$$.fragment,l),n=!0)},o(l){k(e.$$.fragment,l),k(s.$$.fragment,l),n=!1},d(l){l&&T(t),q(e,l),q(s,l)}}}function nt(a,e,t){Se(async()=>{await Ae(),await ze()});let s,n,l="",c={lng:0,lat:0},u={type:"FeatureCollection",features:[]},i="",r=1e3,o="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function L(m){t(0,l=""),t(7,i="Loading file"),p(await y.files[0].arrayBuffer())}function p(m){try{t(4,n=new De(new Uint8Array(m))),t(2,o="Distance");let M=n.getBounds();s.fitBounds([[M[0],M[1]],[M[2],M[3]]],{padding:20,animate:!1}),t(5,c.lng=(M[0]+M[2])/2,c),t(5,c.lat=(M[1]+M[3])/2,c),E()}catch(M){window.alert(`Problem importing osm.pbf file: ${M}`)}t(7,i="")}async function w(m){if(m!=""){t(7,i=`Loading ${m}`);let M=await fetch(`https://assets.od2net.org/pbf_clips/${m}.osm.pbf`);p(await M.arrayBuffer())}}function E(){n&&t(6,u=JSON.parse(n.recalculate({lng:c.lng,lat:c.lat,max_requests:r,cost:o})))}function D(m,M){E()}function P(m){t(7,i="Parsing XML"),p(new TextEncoder().encode(m.detail)),t(7,i="")}function F(m){c=m,t(5,c)}function N(m){s=m,t(3,s)}function X(m){H[m?"unshift":"push"](()=>{y=m,t(9,y)})}function j(m){l=m,t(0,l)}const _=m=>t(7,i=m.detail),b=m=>t(7,i=m.detail);function g(){r=ce(this.value),t(1,r)}function B(m){o=m,t(2,o)}function C(m){d=m,t(8,d)}return a.$$.update=()=>{a.$$.dirty&1&&w(l),a.$$.dirty&6&&D()},[l,r,o,s,n,c,u,i,d,y,L,E,P,F,N,X,j,_,b,g,B,C]}class at extends re{constructor(e){super(),ie(this,e,nt,tt,fe,{})}}new at({target:document.getElementById("app")});
