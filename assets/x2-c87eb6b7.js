import{S as ie,i as re,s as fe,G as pe,e as q,h as j,z as K,l as D,I as $,q as J,J as V,K as _e,N as be,O as he,Q as we,R as Le,t as w,b as k,v as R,w as ye,T as ke,U as Ce,V as Y,W as ee,m as ve,L as Me,c as P,f as I,a as z,d as O,o as Be,H as Se,x as G,y as W,g as x,n as M,A as Q,r as te,u as ne,M as Ee,_ as Pe,X as ue,j as ae,D as ze,E as Oe,Y as Ie}from"./Layout-6a808470.js";import{L as qe,C as De,O as Re,_ as Te,J as Je,a as je,G as Ae,P as Fe}from"./index-34f7e0df.js";import{S as Ne,L as Xe}from"./SidebarControls-b43115a7.js";const Ze=a=>({marker:a&8}),se=a=>({marker:a[3]});function Ge(a){let e,t,o,n,i,f,c;const l=a[19].default,r=pe(l,a,a[18],se);return{c(){e=q("div"),r&&r.c(),j(e,"tabindex",t=a[1]?0:void 0),j(e,"role",o=a[1]?"button":void 0),K(e,"z-index",a[2])},m(s,d){D(s,e,d),r&&r.m(e,null),i=!0,f||(c=[$(a[7].call(null,e)),$(n=He.call(null,e,a[0])),J(e,"click",V(a[20])),J(e,"dblclick",V(a[21])),J(e,"contextmenu",V(_e(a[22]))),J(e,"mouseenter",a[23]),J(e,"mouseleave",a[24]),J(e,"mousemove",a[25]),J(e,"keydown",a[8])],f=!0)},p(s,[d]){r&&r.p&&(!i||d&262152)&&be(r,l,s,s[18],i?we(l,s[18],d,Ze):he(s[18]),se),(!i||d&2&&t!==(t=s[1]?0:void 0))&&j(e,"tabindex",t),(!i||d&2&&o!==(o=s[1]?"button":void 0))&&j(e,"role",o),n&&Le(n.update)&&d&1&&n.update.call(null,s[0]),d&4&&K(e,"z-index",s[2])},i(s){i||(w(r,s),i=!0)},o(s){k(r,s),i=!1},d(s){s&&R(e),r&&r.d(s),f=!1,ye(c)}}}function He(a,e){const t=a.className;function o(n){n?a.className=`${t} ${n}`:a.className=t}return o(e),{update:o}}function Ue(a,e,t){let o,n,i,{$$slots:f={},$$scope:c}=e,{marker:l=void 0}=e,{lngLat:r}=e,{class:s=void 0}=e,{interactive:d=!0}=e,{asButton:y=!1}=e,{draggable:_=!1}=e,{feature:C=null}=e,{offset:m=void 0}=e,{zIndex:L=void 0}=e,{rotation:B=0}=e,{opacity:T=1}=e;const H=ke(),{map:A,layerEvent:b,self:h,markerClickManager:p}=Ce();Y(a,A,u=>t(27,i=u)),Y(a,b,u=>t(26,o=u)),Y(a,h,u=>t(3,n=u));function E(u){ee(h,n=new ve.Marker({element:u,rotation:B,draggable:_,offset:m,opacity:T.toString()}).setLngLat(r).addTo(i),n),t(11,l=n);const X=()=>S("dragstart"),U=()=>{F(),S("drag")},Z=()=>{F(),S("dragend")};return _&&(n.on("dragstart",X),n.on("drag",U),n.on("dragend",Z)),{destroy(){_&&(n==null||n.off("dragstart",X),n==null||n.off("drag",U),n==null||n.off("dragend",Z)),t(11,l=void 0),n==null||n.remove()}}}function F(){let u=n==null?void 0:n.getLngLat();u&&(Array.isArray(r)?t(10,r=[u.lng,u.lat]):r&&"lon"in r?t(10,r={lon:u.lng,lat:u.lat}):t(10,r=u))}function N(u){u.key===" "&&(u.preventDefault(),u.stopPropagation(),S("click"))}function S(u){if(!d)return;let X=n==null?void 0:n.getLngLat();if(!X)return;const U=[X.lng,X.lat];let Z={map:i,marker:n,lngLat:U,features:[{type:"Feature",properties:(C==null?void 0:C.properties)??{},geometry:{type:"Point",coordinates:U}}]};(u==="click"||u==="contextmenu")&&p.handleClick(Z),ee(b,o={...Z,layerType:"marker",type:u},o),H(u,Z)}const g=()=>S("click"),v=()=>S("dblclick"),ce=()=>{S("contextmenu")},de=()=>{S("mouseenter")},ge=()=>{S("mouseleave")},me=()=>S("mousemove");return a.$$set=u=>{"marker"in u&&t(11,l=u.marker),"lngLat"in u&&t(10,r=u.lngLat),"class"in u&&t(0,s=u.class),"interactive"in u&&t(12,d=u.interactive),"asButton"in u&&t(1,y=u.asButton),"draggable"in u&&t(13,_=u.draggable),"feature"in u&&t(14,C=u.feature),"offset"in u&&t(15,m=u.offset),"zIndex"in u&&t(2,L=u.zIndex),"rotation"in u&&t(16,B=u.rotation),"opacity"in u&&t(17,T=u.opacity),"$$scope"in u&&t(18,c=u.$$scope)},a.$$.update=()=>{a.$$.dirty&1032&&(n==null||n.setLngLat(r)),a.$$.dirty&32776&&(n==null||n.setOffset(m??[0,0])),a.$$.dirty&65544&&(n==null||n.setRotation(B)),a.$$.dirty&131080&&(n==null||n.setOpacity(T.toString()))},[s,y,L,n,A,b,h,E,N,S,r,l,d,_,C,m,B,T,c,f,g,v,ce,de,ge,me]}class Ke extends ie{constructor(e){super(),re(this,e,Ue,Ge,fe,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}const We=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function oe(a){let e,t,o,n,i,f,c,l,r,s,d,y;function _(m){a[20](m)}let C={};return a[2]!==void 0&&(C.cost=a[2]),l=new je({props:C}),G.push(()=>W(l,"cost",_)),{c(){e=q("div"),t=q("label"),o=x(`Max requests (limit for faster updates):
          `),n=q("br"),i=I(),f=q("input"),c=I(),P(l.$$.fragment),j(f,"type","number"),j(f,"min",1)},m(m,L){D(m,e,L),M(e,t),M(t,o),M(t,n),M(t,i),M(t,f),ae(f,a[1]),D(m,c,L),z(l,m,L),s=!0,d||(y=J(f,"input",a[19]),d=!0)},p(m,L){L&2&&ue(f.value)!==m[1]&&ae(f,m[1]);const B={};!r&&L&4&&(r=!0,B.cost=m[2],Q(()=>r=!1)),l.$set(B)},i(m){s||(w(l.$$.fragment,m),s=!0)},o(m){k(l.$$.fragment,m),s=!1},d(m){m&&(R(e),R(c)),O(l,m),d=!1,y()}}}function le(a){let e,t,o,n,i;function f(l){a[21](l)}let c={outputMetadata:a[6].metadata,map:a[3]};return a[8]!==void 0&&(c.controls=a[8]),o=new Ne({props:c}),G.push(()=>W(o,"controls",f)),{c(){e=q("hr"),t=I(),P(o.$$.fragment)},m(l,r){D(l,e,r),D(l,t,r),z(o,l,r),i=!0},p(l,r){const s={};r&64&&(s.outputMetadata=l[6].metadata),r&8&&(s.map=l[3]),!n&&r&256&&(n=!0,s.controls=l[8],Q(()=>n=!1)),o.$set(s)},i(l){i||(w(o.$$.fragment,l),i=!0)},o(l){k(o.$$.fragment,l),i=!1},d(l){l&&(R(e),R(t)),O(o,l)}}}function Qe(a){let e,t,o,n,i,f,c,l,r,s,d,y,_,C,m,L,B,T;t=new Se({props:{app:"interactive"}});function H(p){a[16](p)}let A={};a[0]!==void 0&&(A.example=a[0]),s=new De({props:A}),G.push(()=>W(s,"example",H)),_=new Re({props:{map:a[3]}}),_.$on("gotXml",a[12]),_.$on("loading",a[17]),_.$on("error",a[18]);let b=a[4]&&oe(a),h=a[6].metadata&&le(a);return{c(){e=q("div"),P(t.$$.fragment),o=I(),n=q("label"),i=x("Open an "),f=q("i"),f.textContent=".osm.pbf",c=x(`
      file
      `),l=q("input"),r=I(),P(s.$$.fragment),y=I(),P(_.$$.fragment),C=I(),b&&b.c(),m=I(),h&&h.c(),j(l,"type","file"),j(e,"slot","left")},m(p,E){D(p,e,E),z(t,e,null),M(e,o),M(e,n),M(n,i),M(n,f),M(n,c),M(n,l),a[15](l),M(e,r),z(s,e,null),M(e,y),z(_,e,null),M(e,C),b&&b.m(e,null),M(e,m),h&&h.m(e,null),L=!0,B||(T=J(l,"change",a[10]),B=!0)},p(p,E){const F={};!d&&E&1&&(d=!0,F.example=p[0],Q(()=>d=!1)),s.$set(F);const N={};E&8&&(N.map=p[3]),_.$set(N),p[4]?b?(b.p(p,E),E&16&&w(b,1)):(b=oe(p),b.c(),w(b,1),b.m(e,m)):b&&(te(),k(b,1,1,()=>{b=null}),ne()),p[6].metadata?h?(h.p(p,E),E&64&&w(h,1)):(h=le(p),h.c(),w(h,1),h.m(e,null)):h&&(te(),k(h,1,1,()=>{h=null}),ne())},i(p){L||(w(t.$$.fragment,p),w(s.$$.fragment,p),w(_.$$.fragment,p),w(b),w(h),L=!0)},o(p){k(t.$$.fragment,p),k(s.$$.fragment,p),k(_.$$.fragment,p),k(b),k(h),L=!1},d(p){p&&R(e),O(t),a[15](null),O(s),O(_),b&&b.d(),h&&h.d(),B=!1,T()}}}function Ve(a){let e,t;return{c(){e=new Ie(!1),t=ze(),e.a=t},m(o,n){e.m(We,o,n),D(o,t,n)},p:Oe,d(o){o&&(R(t),e.d())}}}function Ye(a){let e,t;return e=new Xe({props:{controls:a[8]}}),{c(){P(e.$$.fragment)},m(o,n){z(e,o,n),t=!0},p(o,n){const i={};n&256&&(i.controls=o[8]),e.$set(i)},i(o){t||(w(e.$$.fragment,o),t=!0)},o(o){k(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function xe(a){let e,t,o,n,i,f,c;function l(s){a[13](s)}let r={draggable:!0,$$slots:{default:[Ve]},$$scope:{ctx:a}};return a[5]!==void 0&&(r.lngLat=a[5]),e=new Ke({props:r}),G.push(()=>W(e,"lngLat",l)),e.$on("dragend",a[11]),n=new Ae({props:{data:a[6],$$slots:{default:[Ye]},$$scope:{ctx:a}}}),f=new Fe({}),{c(){P(e.$$.fragment),o=I(),P(n.$$.fragment),i=I(),P(f.$$.fragment)},m(s,d){z(e,s,d),D(s,o,d),z(n,s,d),D(s,i,d),z(f,s,d),c=!0},p(s,d){const y={};d&33554432&&(y.$$scope={dirty:d,ctx:s}),!t&&d&32&&(t=!0,y.lngLat=s[5],Q(()=>t=!1)),e.$set(y);const _={};d&64&&(_.data=s[6]),d&33554688&&(_.$$scope={dirty:d,ctx:s}),n.$set(_)},i(s){c||(w(e.$$.fragment,s),w(n.$$.fragment,s),w(f.$$.fragment,s),c=!0)},o(s){k(e.$$.fragment,s),k(n.$$.fragment,s),k(f.$$.fragment,s),c=!1},d(s){s&&(R(o),R(i)),O(e,s),O(n,s),O(f,s)}}}function $e(a){let e,t,o,n;function i(c){a[14](c)}let f={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[xe]},$$scope:{ctx:a}};return a[3]!==void 0&&(f.map=a[3]),t=new Ee({props:f}),G.push(()=>W(t,"map",i)),{c(){e=q("div"),P(t.$$.fragment),j(e,"slot","main"),K(e,"position","relative"),K(e,"width","100%"),K(e,"height","100vh")},m(c,l){D(c,e,l),z(t,e,null),n=!0},p(c,l){const r={};l&33554784&&(r.$$scope={dirty:l,ctx:c}),!o&&l&8&&(o=!0,r.map=c[3],Q(()=>o=!1)),t.$set(r)},i(c){n||(w(t.$$.fragment,c),n=!0)},o(c){k(t.$$.fragment,c),n=!1},d(c){c&&R(e),O(t)}}}function et(a){let e,t,o,n;return e=new Me({props:{$$slots:{main:[$e],left:[Qe]},$$scope:{ctx:a}}}),o=new qe({props:{loading:a[7]}}),{c(){P(e.$$.fragment),t=I(),P(o.$$.fragment)},m(i,f){z(e,i,f),D(i,t,f),z(o,i,f),n=!0},p(i,[f]){const c={};f&33555455&&(c.$$scope={dirty:f,ctx:i}),e.$set(c);const l={};f&128&&(l.loading=i[7]),o.$set(l)},i(i){n||(w(e.$$.fragment,i),w(o.$$.fragment,i),n=!0)},o(i){k(e.$$.fragment,i),k(o.$$.fragment,i),n=!1},d(i){i&&R(t),O(e,i),O(o,i)}}}function tt(a,e,t){Be(async()=>{await Te(),await Pe()});let o,n,i="",f={lng:0,lat:0},c={type:"FeatureCollection",features:[]},l="",r=1e3,s="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function _(g){t(0,i=""),t(7,l="Loading file"),C(await y.files[0].arrayBuffer())}function C(g){try{t(4,n=new Je(new Uint8Array(g))),t(2,s="Distance");let v=n.getBounds();o.fitBounds([[v[0],v[1]],[v[2],v[3]]],{padding:20,animate:!1}),t(5,f.lng=(v[0]+v[2])/2,f),t(5,f.lat=(v[1]+v[3])/2,f),L()}catch(v){window.alert(`Problem importing osm.pbf file: ${v}`)}t(7,l="")}async function m(g){if(g!=""){t(7,l=`Loading ${g}`);let v=await fetch(`https://assets.od2net.org/pbf_clips/${g}.osm.pbf`);C(await v.arrayBuffer())}}function L(){n&&t(6,c=JSON.parse(n.recalculate({lng:f.lng,lat:f.lat,max_requests:r,cost:s})))}function B(g,v){L()}function T(g){t(7,l="Parsing XML"),C(new TextEncoder().encode(g.detail)),t(7,l="")}function H(g){f=g,t(5,f)}function A(g){o=g,t(3,o)}function b(g){G[g?"unshift":"push"](()=>{y=g,t(9,y)})}function h(g){i=g,t(0,i)}const p=g=>t(7,l=g.detail),E=g=>t(7,l=g.detail);function F(){r=ue(this.value),t(1,r)}function N(g){s=g,t(2,s)}function S(g){d=g,t(8,d)}return a.$$.update=()=>{a.$$.dirty&1&&m(i),a.$$.dirty&6&&B()},[i,r,s,o,n,f,c,l,d,y,_,L,T,H,A,b,h,p,E,F,N,S]}class nt extends ie{constructor(e){super(),re(this,e,tt,et,fe,{})}}new nt({target:document.getElementById("app")});
