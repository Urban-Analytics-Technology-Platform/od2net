import{S as ie,i as re,s as fe,G as pe,e as O,h as N,z as W,l as D,I as x,q as J,J as de,K as me,N as ge,O as _e,t as y,b as k,v as R,w as be,Q as he,R as we,T as $,U as ee,m as Le,L as ye,c as P,f as z,a as I,d as q,o as ve,H as Ce,x as H,y as Q,g as Y,n as C,A as V,r as te,u as ne,M as ke,_ as Me,V as ue,W as Be,j as se,D as Se,E as Ee,X as ze}from"./SequentialLegend-89cac39e.js";import{L as Oe,C as Pe,O as Ie,_ as qe,J as De,a as Re,G as Te,P as Je}from"./OverpassSelector-70737ec4.js";import{S as Ne,L as je}from"./SidebarControls-c8821124.js";function Ae(s){let e,t,l,n,i,r,c;const o=s[18].default,u=pe(o,s,s[17],null);return{c(){e=O("div"),u&&u.c(),N(e,"tabindex",t=s[1]?0:void 0),N(e,"role",l=s[1]?"button":void 0),W(e,"z-index",s[2])},m(a,d){D(a,e,d),u&&u.m(e,null),i=!0,r||(c=[x(s[6].call(null,e)),x(n=Fe.call(null,e,s[0])),J(e,"click",s[19]),J(e,"dblclick",s[20]),J(e,"contextmenu",s[21]),J(e,"mouseenter",s[22]),J(e,"mouseleave",s[23]),J(e,"mousemove",s[24]),J(e,"keydown",s[7])],r=!0)},p(a,[d]){u&&u.p&&(!i||d&131072)&&de(u,o,a,a[17],i?ge(o,a[17],d,null):me(a[17]),null),(!i||d&2&&t!==(t=a[1]?0:void 0))&&N(e,"tabindex",t),(!i||d&2&&l!==(l=a[1]?"button":void 0))&&N(e,"role",l),n&&_e(n.update)&&d&1&&n.update.call(null,a[0]),d&4&&W(e,"z-index",a[2])},i(a){i||(y(u,a),i=!0)},o(a){k(u,a),i=!1},d(a){a&&R(e),u&&u.d(a),r=!1,be(c)}}}function Fe(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function Xe(s,e,t){let l,n,i,{$$slots:r={},$$scope:c}=e,{lngLat:o}=e,{class:u=void 0}=e,{interactive:a=!0}=e,{asButton:d=!1}=e,{draggable:w=!1}=e,{feature:_=null}=e,{offset:B=void 0}=e,{zIndex:g=void 0}=e,{rotation:L=0}=e,{opacity:S=1}=e;const T=he(),{map:A,layerEvent:F,self:j}=we();$(s,A,f=>t(26,i=f)),$(s,F,f=>t(25,l=f)),$(s,j,f=>t(16,n=f));function v(f){ee(j,n=new Le.Marker({element:f,rotation:L,draggable:w,offset:B,opacity:S.toString()}).setLngLat(o).addTo(i),n);const G=()=>p("dragstart"),U=()=>{b(),p("drag")},K=()=>{b(),p("dragend")};return w&&(n.on("dragstart",G),n.on("drag",U),n.on("dragend",K)),{destroy(){w&&(n==null||n.off("dragstart",G),n==null||n.off("drag",U),n==null||n.off("dragend",K)),n==null||n.remove()}}}function b(){let f=n==null?void 0:n.getLngLat();f&&(Array.isArray(o)?t(9,o=[f.lng,f.lat]):o&&"lon"in o?t(9,o={lon:f.lng,lat:f.lat}):t(9,o=f))}function h(f){f.key===" "&&(f.preventDefault(),f.stopPropagation(),p("click"))}function p(f){if(!a)return;let G=n==null?void 0:n.getLngLat();if(!G)return;const U=[G.lng,G.lat];let K={map:i,marker:n,lngLat:U,features:[{type:"Feature",properties:(_==null?void 0:_.properties)??{},geometry:{type:"Point",coordinates:U}}]};ee(F,l={...K,layerType:"marker",type:f},l),T(f,K)}const E=()=>p("click"),X=()=>p("dblclick"),Z=()=>p("contextmenu"),m=f=>{p("mouseenter")},M=()=>{p("mouseleave")},ce=()=>p("mousemove");return s.$$set=f=>{"lngLat"in f&&t(9,o=f.lngLat),"class"in f&&t(0,u=f.class),"interactive"in f&&t(10,a=f.interactive),"asButton"in f&&t(1,d=f.asButton),"draggable"in f&&t(11,w=f.draggable),"feature"in f&&t(12,_=f.feature),"offset"in f&&t(13,B=f.offset),"zIndex"in f&&t(2,g=f.zIndex),"rotation"in f&&t(14,L=f.rotation),"opacity"in f&&t(15,S=f.opacity),"$$scope"in f&&t(17,c=f.$$scope)},s.$$.update=()=>{s.$$.dirty&66048&&(n==null||n.setLngLat(o)),s.$$.dirty&73728&&(n==null||n.setOffset(B??[0,0])),s.$$.dirty&81920&&(n==null||n.setRotation(L)),s.$$.dirty&98304&&(n==null||n.setOpacity(S.toString()))},[u,d,g,A,F,j,v,h,p,o,a,w,_,B,L,S,n,c,r,E,X,Z,m,M,ce]}class Ze extends ie{constructor(e){super(),re(this,e,Xe,Ae,fe,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2,rotation:14,opacity:15})}}const Ge=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function ae(s){let e,t;return{c(){e=O("p"),t=Y(s[10])},m(l,n){D(l,e,n),C(e,t)},p(l,n){n&1024&&Be(t,l[10])},d(l){l&&R(e)}}}function le(s){let e,t,l,n,i,r,c,o,u,a,d,w;function _(g){s[21](g)}let B={};return s[2]!==void 0&&(B.cost=s[2]),o=new Re({props:B}),H.push(()=>Q(o,"cost",_)),{c(){e=O("div"),t=O("label"),l=Y(`Max requests (limit for faster updates):
          `),n=O("br"),i=z(),r=O("input"),c=z(),P(o.$$.fragment),N(r,"type","number"),N(r,"min",1)},m(g,L){D(g,e,L),C(e,t),C(t,l),C(t,n),C(t,i),C(t,r),se(r,s[1]),D(g,c,L),I(o,g,L),a=!0,d||(w=J(r,"input",s[20]),d=!0)},p(g,L){L&2&&ue(r.value)!==g[1]&&se(r,g[1]);const S={};!u&&L&4&&(u=!0,S.cost=g[2],V(()=>u=!1)),o.$set(S)},i(g){a||(y(o.$$.fragment,g),a=!0)},o(g){k(o.$$.fragment,g),a=!1},d(g){g&&(R(e),R(c)),q(o,g),d=!1,w()}}}function oe(s){let e,t,l,n,i;function r(o){s[22](o)}let c={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(c.controls=s[8]),l=new Ne({props:c}),H.push(()=>Q(l,"controls",r)),{c(){e=O("hr"),t=z(),P(l.$$.fragment)},m(o,u){D(o,e,u),D(o,t,u),I(l,o,u),i=!0},p(o,u){const a={};u&64&&(a.outputMetadata=o[6].metadata),u&8&&(a.map=o[3]),!n&&u&256&&(n=!0,a.controls=o[8],V(()=>n=!1)),l.$set(a)},i(o){i||(y(l.$$.fragment,o),i=!0)},o(o){k(l.$$.fragment,o),i=!1},d(o){o&&(R(e),R(t)),q(l,o)}}}function He(s){let e,t,l,n,i,r,c,o,u,a,d,w,_,B,g,L,S,T,A;t=new Ce({props:{app:"interactive"}});function F(p){s[17](p)}let j={};s[0]!==void 0&&(j.example=s[0]),a=new Pe({props:j}),H.push(()=>Q(a,"example",F)),_=new Ie({props:{map:s[3]}}),_.$on("gotXml",s[13]),_.$on("loading",s[18]),_.$on("error",s[19]);let v=s[10]&&ae(s),b=s[4]&&le(s),h=s[6].metadata&&oe(s);return{c(){e=O("div"),P(t.$$.fragment),l=z(),n=O("label"),i=Y("Open an "),r=O("i"),r.textContent=".osm.pbf",c=Y(`
      file
      `),o=O("input"),u=z(),P(a.$$.fragment),w=z(),P(_.$$.fragment),B=z(),v&&v.c(),g=z(),b&&b.c(),L=z(),h&&h.c(),N(o,"type","file"),N(e,"slot","left")},m(p,E){D(p,e,E),I(t,e,null),C(e,l),C(e,n),C(n,i),C(n,r),C(n,c),C(n,o),s[16](o),C(e,u),I(a,e,null),C(e,w),I(_,e,null),C(e,B),v&&v.m(e,null),C(e,g),b&&b.m(e,null),C(e,L),h&&h.m(e,null),S=!0,T||(A=J(o,"change",s[11]),T=!0)},p(p,E){const X={};!d&&E&1&&(d=!0,X.example=p[0],V(()=>d=!1)),a.$set(X);const Z={};E&8&&(Z.map=p[3]),_.$set(Z),p[10]?v?v.p(p,E):(v=ae(p),v.c(),v.m(e,g)):v&&(v.d(1),v=null),p[4]?b?(b.p(p,E),E&16&&y(b,1)):(b=le(p),b.c(),y(b,1),b.m(e,L)):b&&(te(),k(b,1,1,()=>{b=null}),ne()),p[6].metadata?h?(h.p(p,E),E&64&&y(h,1)):(h=oe(p),h.c(),y(h,1),h.m(e,null)):h&&(te(),k(h,1,1,()=>{h=null}),ne())},i(p){S||(y(t.$$.fragment,p),y(a.$$.fragment,p),y(_.$$.fragment,p),y(b),y(h),S=!0)},o(p){k(t.$$.fragment,p),k(a.$$.fragment,p),k(_.$$.fragment,p),k(b),k(h),S=!1},d(p){p&&R(e),q(t),s[16](null),q(a),q(_),v&&v.d(),b&&b.d(),h&&h.d(),T=!1,A()}}}function Ue(s){let e,t;return{c(){e=new ze(!1),t=Se(),e.a=t},m(l,n){e.m(Ge,l,n),D(l,t,n)},p:Ee,d(l){l&&(R(t),e.d())}}}function Ke(s){let e,t;return e=new je({props:{controls:s[8]}}),{c(){P(e.$$.fragment)},m(l,n){I(e,l,n),t=!0},p(l,n){const i={};n&256&&(i.controls=l[8]),e.$set(i)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){k(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}function We(s){let e,t,l,n,i,r,c;function o(a){s[14](a)}let u={draggable:!0,$$slots:{default:[Ue]},$$scope:{ctx:s}};return s[5]!==void 0&&(u.lngLat=s[5]),e=new Ze({props:u}),H.push(()=>Q(e,"lngLat",o)),e.$on("dragend",s[12]),n=new Te({props:{data:s[6],$$slots:{default:[Ke]},$$scope:{ctx:s}}}),r=new Je({}),{c(){P(e.$$.fragment),l=z(),P(n.$$.fragment),i=z(),P(r.$$.fragment)},m(a,d){I(e,a,d),D(a,l,d),I(n,a,d),D(a,i,d),I(r,a,d),c=!0},p(a,d){const w={};d&67108864&&(w.$$scope={dirty:d,ctx:a}),!t&&d&32&&(t=!0,w.lngLat=a[5],V(()=>t=!1)),e.$set(w);const _={};d&64&&(_.data=a[6]),d&67109120&&(_.$$scope={dirty:d,ctx:a}),n.$set(_)},i(a){c||(y(e.$$.fragment,a),y(n.$$.fragment,a),y(r.$$.fragment,a),c=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),k(r.$$.fragment,a),c=!1},d(a){a&&(R(l),R(i)),q(e,a),q(n,a),q(r,a)}}}function Qe(s){let e,t,l,n;function i(c){s[15](c)}let r={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[We]},$$scope:{ctx:s}};return s[3]!==void 0&&(r.map=s[3]),t=new ke({props:r}),H.push(()=>Q(t,"map",i)),{c(){e=O("div"),P(t.$$.fragment),N(e,"slot","main"),W(e,"position","relative"),W(e,"width","100%"),W(e,"height","100vh")},m(c,o){D(c,e,o),I(t,e,null),n=!0},p(c,o){const u={};o&67109216&&(u.$$scope={dirty:o,ctx:c}),!l&&o&8&&(l=!0,u.map=c[3],V(()=>l=!1)),t.$set(u)},i(c){n||(y(t.$$.fragment,c),n=!0)},o(c){k(t.$$.fragment,c),n=!1},d(c){c&&R(e),q(t)}}}function Ve(s){let e,t,l,n;return e=new ye({props:{$$slots:{main:[Qe],left:[He]},$$scope:{ctx:s}}}),l=new Oe({props:{loading:s[7]}}),{c(){P(e.$$.fragment),t=z(),P(l.$$.fragment)},m(i,r){I(e,i,r),D(i,t,r),I(l,i,r),n=!0},p(i,[r]){const c={};r&67110783&&(c.$$scope={dirty:r,ctx:i}),e.$set(c);const o={};r&128&&(o.loading=i[7]),l.$set(o)},i(i){n||(y(e.$$.fragment,i),y(l.$$.fragment,i),n=!0)},o(i){k(e.$$.fragment,i),k(l.$$.fragment,i),n=!1},d(i){i&&R(t),q(e,i),q(l,i)}}}function Ye(s,e,t){ve(async()=>{await qe(),await Me()});let l,n,i="",r={lng:0,lat:0},c={type:"FeatureCollection",features:[]},o=!1,u=1e3,a="Distance",d={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},w;async function _(m){t(0,i=""),t(7,o=!0),B(await w.files[0].arrayBuffer())}function B(m){try{t(4,n=new De(new Uint8Array(m))),t(2,a="Distance");let M=n.getBounds();l.fitBounds([[M[0],M[1]],[M[2],M[3]]],{padding:20,animate:!1}),t(5,r.lng=(M[0]+M[2])/2,r),t(5,r.lat=(M[1]+M[3])/2,r),L()}catch(M){window.alert(`Problem importing osm.pbf file: ${M}`)}t(7,o=!1)}async function g(m){if(m!=""){t(7,o=!0);let M=await fetch(`https://assets.od2net.org/pbf_clips/${m}.osm.pbf`);B(await M.arrayBuffer())}}function L(){n&&t(6,c=JSON.parse(n.recalculate({lng:r.lng,lat:r.lat,max_requests:u,cost:a})))}function S(m,M){L()}let T="";function A(m){t(10,T="Parsing XML"),B(new TextEncoder().encode(m.detail)),t(10,T="")}function F(m){r=m,t(5,r)}function j(m){l=m,t(3,l)}function v(m){H[m?"unshift":"push"](()=>{w=m,t(9,w)})}function b(m){i=m,t(0,i)}const h=m=>t(10,T=m.detail),p=m=>t(10,T=m.detail);function E(){u=ue(this.value),t(1,u)}function X(m){a=m,t(2,a)}function Z(m){d=m,t(8,d)}return s.$$.update=()=>{s.$$.dirty&1&&g(i),s.$$.dirty&6&&S()},[i,u,a,l,n,r,c,o,d,w,T,_,L,A,F,j,v,b,h,p,E,X,Z]}class $e extends ie{constructor(e){super(),re(this,e,Ye,Ve,fe,{})}}new $e({target:document.getElementById("app")});
